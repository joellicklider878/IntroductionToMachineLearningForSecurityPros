# Update Windows
Start-Process powershell -ArgumentList "Start-Process -Verb runAs powershell -ArgumentList 'saps powershell -args '-ExecutionPolicy Unrestricted -Command \"Install-Module -Name PSWindowsUpdate -Force; Import-Module PSWindowsUpdate; Get-WindowsUpdate -Install\"'" -Wait

# Install ActiveState Python 3
Start-Process powershell -ArgumentList "Start-Process -Verb runAs msiexec -ArgumentList '/i https://downloads.activestate.com/ActivePython/releases/3.8.10.0/ActivePython-3.8.10.0-win64-x64.msi /qn' -Wait

# Install dependencies
& $env:APPDATA\ActiveState\pkg\bin\state.exe activate --default ActiveState/ActivePython-3.8
& $env:APPDATA\ActiveState\pkg\bin\state.exe install numpy scipy scikit-learn keras theano tensorflow h5py matplotlib gevent requests ssdeep

# Clone the repository
git clone https://github.com/CylanceSPEAR/IntroductionToMachineLearningForSecurityPros.git

# Change directory to the cloned repository
Set-Location -Path .\IntroductionToMachineLearningForSecurityPros\

# Decompress .lzma files
Get-ChildItem -Recurse -Filter *.lzma | ForEach-Object { & 'C:\Program Files\7-Zip\7z.exe' x $_.FullName }

